
plot_probabilities <- function() {
  plot(
    seq(carbondate_start, by = carbondate_resolution, length.out = length(carbondate_prob)),
    carbondate_prob*carbondate_probnorm,
    col = "blue",
    xlab = "Calendar Age AD",
    ylab = "Probability",
    main = title,
    type = "o")
  lines(seq(oxcal_start, by = oxcal_resolution, length.out = length(oxcal_prob)), oxcal_prob*oxcal_probnorm, col = "Red")
  legend("topright", c("carbondate", "OxCal"), col = c("blue", "red"), lty = c(1, 1), pch = c("o", NA))
}

title = "R_Date (1432, 32)"
carbondate_probnorm = 0.019875
carbondate_prob = c(0.000000, 0.000002, 0.000011, 0.000026, 0.000012, 0.000010, 0.000009, 0.000002, 0.000001, 0.000003, 0.000023, 0.000044, 0.000041, 0.000018, 0.000003, 0.000002, 0.000004, 0.000004, 0.000001, 0.000001, 0.000003, 0.000023, 0.000167, 0.001052, 0.003664, 0.006207, 0.009458, 0.019394, 0.040539, 0.071295, 0.096922, 0.117693, 0.144610, 0.206631, 0.378524, 0.698763, 0.919541, 0.948906, 0.881594, 0.770462, 0.676263, 0.729201, 0.930468, 1.000000, 0.774637, 0.404073, 0.155463, 0.047705, 0.013320, 0.004253, 0.001619, 0.000610, 0.000184, 0.000136, 0.000245, 0.000061, 0.000004, 0.000006, 0.000005, 0.000014, 0.000019, 0.000017, 0.000108, 0.000775, 0.001745, 0.003571, 0.000708, 0.000460, 0.00137)
carbondate_start = 430
carbondate_resolution = 5
oxcal_probnorm =0.0201178;
oxcal_prob = c(0.000000, 0.000000, 0.000000, 0.000002, 0.000012, 0.000030, 0.000013, 0.000011, 0.000010, 0.000002, 0.000001, 0.000003, 0.000024, 0.000048, 0.000046, 0.000017, 0.000003, 0.000002, 0.000004, 0.000005, 0.000001, 0.000001, 0.000004, 0.000019, 0.000150, 0.001021, 0.003726, 0.006412, 0.009210, 0.018636, 0.039042, 0.068349, 0.094613, 0.114901, 0.140691, 0.203388, 0.370999, 0.691437, 0.913139, 0.939615, 0.873670, 0.762265, 0.667068, 0.723101, 0.929428, 1.000000, 0.767365, 0.390616, 0.143246, 0.043630, 0.011731, 0.003786, 0.001442, 0.000463, 0.000150, 0.000114, 0.000213, 0.000037, 0.000003, 0.000004, 0.000003, 0.000011, 0.000015, 0.000014, 0.000070, 0.000643, 0.001546, 0.003241, 0.000508, 0.000355, 0.000956, 0.000186, 0.000000, 0.000000, 0.000000)
oxcal_start = 420.5
oxcal_resolution = 5
plot_probabilities()

title = "R_Date(1222,34)"
carbondate_probnorm = 0.008096
carbondate_prob = c(0.000001, 0.000015, 0.000208, 0.001895, 0.010051, 0.030639, 0.068574, 0.133133, 0.209324, 0.292445, 0.298301, 0.237174, 0.425582, 0.691673, 0.665101, 0.672047, 0.539423, 0.495401, 0.508770, 0.331886, 0.137456, 0.085576, 0.054022, 0.156930, 0.181160, 0.103583, 0.591582, 0.399450, 0.691475, 0.971860, 0.995883, 1.000000, 0.984151, 0.983989, 0.993526, 0.975408, 0.893572, 0.758317, 0.663442, 0.635172, 0.665308, 0.725728, 0.780954, 0.826534, 0.842627, 0.824187, 0.734201, 0.550005, 0.312342, 0.119932, 0.033643, 0.009488, 0.004473, 0.003900, 0.006950, 0.015789, 0.035521, 0.060339, 0.071920, 0.066761, 0.050493, 0.030720, 0.016904, 0.011115, 0.009836, 0.013957, 0.006649, 0.001305, 0.001653, 0.001037, 0.000016, 0.000000, 0.000004, 0.000008, 0.000005);
carbondate_start = 645
carbondate_resolution = 5
oxcal_probnorm = 0.00812303;
oxcal_prob = c(0.000000, 0.000000, 0.000001, 0.000013, 0.000188, 0.001625, 0.009773, 0.030178, 0.068613, 0.133413, 0.205883, 0.291435, 0.298063, 0.237922, 0.419891, 0.688997, 0.662555, 0.668605, 0.537737, 0.494362, 0.507605, 0.326550, 0.136654, 0.086293, 0.054875, 0.152500, 0.178890, 0.103153, 0.648325, 0.384048, 0.688411, 0.987612, 0.991062, 1.000000, 0.985841, 0.979959, 0.991623, 0.978698, 0.891321, 0.756790, 0.658806, 0.631852, 0.661461, 0.720976, 0.776165, 0.821536, 0.837467, 0.819288, 0.729989, 0.545014, 0.301161, 0.111165, 0.030442, 0.008496, 0.004144, 0.003567, 0.006381, 0.014695, 0.033667, 0.058389, 0.069981, 0.064801, 0.047729, 0.027860, 0.015934, 0.010071, 0.009058, 0.012846, 0.005518, 0.001162, 0.001493, 0.000757, 0.000009, 0.000000, 0.000002, 0.000007, 0.000004, 0.000001, 0.000000, 0.000000);
oxcal_start = 635.5
oxcal_resolution = 5
plot_probabilities()

title = "R_Date(1345,42)"
carbondate_probnorm = 0.015548
carbondate_prob = c(0.000000, 0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000001, 0.000001, 0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000003, 0.000015, 0.000062, 0.000120, 0.000184, 0.000361, 0.000888, 0.001754, 0.002695, 0.003548, 0.004469, 0.006798, 0.015665, 0.047126, 0.111742, 0.137270, 0.112227, 0.078207, 0.053845, 0.056425, 0.106168, 0.235002, 0.472412, 0.771779, 0.979539, 1.000000, 0.882724, 0.725907, 0.572611, 0.448491, 0.340949, 0.301530, 0.370487, 0.271413, 0.115466, 0.115718, 0.111949, 0.150032, 0.184779, 0.172312, 0.247929, 0.471743, 0.599015, 0.718732, 0.539990, 0.409447, 0.596161, 0.144797, 0.000320, 0.001506, 0.009669, 0.025337, 0.018238, 0.015035, 0.014939, 0.020954, 0.017905, 0.009889, 0.004442, 0.002800, 0.002104, 0.002089, 0.002623, 0.003793, 0.005009, 0.005253, 0.004891, 0.003579, 0.001632, 0.000454, 0.000069, 0.000008, 0.000001, 0.000000, 0.000000, 0.000000, 0.000001, 0.000004, 0.000011, 0.000017, 0.000016, 0.000011, 0.000005, 0.000002, 0.000001, 0.000001, 0.000001, 0.000001);
carbondate_start = 439
carbondate_resolution = 5
oxcal_probnorm =0.0157948;
oxcal_start = 470.5;
oxcal_resolution = 5;
oxcal_prob = c(0.000000, 0.000000, 0.000001, 0.000001, 0.000001, 0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000001, 0.000004, 0.000024, 0.000087, 0.000151, 0.000220, 0.000464, 0.001051, 0.002010, 0.002972, 0.003780, 0.004884, 0.007937, 0.019480, 0.057408, 0.120331, 0.134528, 0.103670, 0.071662, 0.053228, 0.061138, 0.121933, 0.268812, 0.526397, 0.823651, 1.000000, 0.978889, 0.846154, 0.687409, 0.537020, 0.415853, 0.317453, 0.305675, 0.363772, 0.219505, 0.104441, 0.113022, 0.109229, 0.157389, 0.176778, 0.170640, 0.277253, 0.498970, 0.611281, 0.713011, 0.471229, 0.430592, 0.561673, 0.053535, 0.000301, 0.001654, 0.011323, 0.023509, 0.015433, 0.013318, 0.014877, 0.019639, 0.014635, 0.007527, 0.003333, 0.002417, 0.001736, 0.001844, 0.002501, 0.003693, 0.004780, 0.004736, 0.004257, 0.002879, 0.001098, 0.000227, 0.000028, 0.000003, 0.000000, 0.000000, 0.000000, 0.000000, 0.000001, 0.000004, 0.000010, 0.000013, 0.000012, 0.000007, 0.000003, 0.000001, 0.000001, 0.000000, 0.000000);

plot_probabilities()




